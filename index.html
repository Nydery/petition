<!DOCTYPE html>
<html lang="de" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Umfrage</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="css/master.css">
  </head>
  <body>
    <div class="navbar">
      <h2>Der neue Kollektivvertrag/Zeitung</h2>
      <h4>2.1.1</h4>
    </div>
    <div class="container">
      <h3 id="firstHeadline">Der neue Kollektivvertrag/Zeitung</h3>
      <br>
    </div>


    <section id="staticSite">
      <div class="container">
        <form action="javascript:checkAnswers()">
          <article id="error" class="errorArticle" hidden>
            <h3>Bitte füllen Sie alle Antworten aus!</h3>
          </article>

          <article class="questionArticle">
            <h5>Zu Ihrer Information</h5>
            <p class="question">
              Diese Umfrage passiert auf Eigeninitiative der Gewerkschaftsmitglieder und soll zur Einschätzung der jetzigen Situation dienen!
              <br>
              Vielen Dank für Ihre Teilnahme!
            </p>
          </article>

          <article class="questionArticle">
            <h5>1. Frage</h5>
            <p class="question">
              Wollen wir einen KV mit 9% Lohneinbußung auf 6 Jahre für alle und deutlicher Verschlechterung für neu Eintritte. Details sind bekannt mit 9 jähriger Laufzeit?
            </p>

            <div class="form-group">
              <label class="answerHead">Ihre Antwort</label>
              <select class="form-control" id="answer1">
                <option>Antwort auswählen. . .</option>
                <option>Ja</option>
                <option>Nein</option>
                <option>Weiss nicht</option>
              </select>

              <div class="form-group">
                <label class="answerHead">Sonstige Kommentare(optional)</label>
                <textarea class="form-control" id="comment1" rows="1"></textarea>
              </div>
            </div>
          </article>

          <article class="questionArticle">
            <h5>2. Frage</h5>
            <p class="question">
              Soll DJP - Vorsitzender Michael Ritzinger zurücktreten?
            </p>

            <div class="form-group">
              <label class="answerHead">Ihre Antwort</label>
              <select class="form-control" id="answer2">
                <option>Antwort auswählen. . .</option>
                <option>Ja</option>
                <option>Nein</option>
                <option>Weiss nicht</option>
              </select>

              <div class="form-group">
                <label class="answerHead">Sonstige Kommentare(optional)</label>
                <textarea class="form-control" id="comment2" rows="1"></textarea>
              </div>
            </div>
          </article>

          <article class="questionArticle">
            <h5>3. Frage</h5>
            <p class="question">
              Soll der neue Kollektivvertrag/Zeitung abgeschlossen werden?
            </p>

            <div class="form-group">
              <label class="answerHead">Ihre Antwort</label>
              <select class="form-control" id="answer3">
                <option>Antwort auswählen. . .</option>
                <option>Ja</option>
                <option>Nein</option>
                <option>Weiss nicht</option>
              </select>

              <div class="form-group">
                <label class="answerHead">Sonstige Kommentare(optional)</label>
                <textarea class="form-control" id="comment3" rows="1"></textarea>
              </div>
            </div>
          </article>

          <article class="questionArticle">
            <h5>4. Frage</h5>
            <p class="question">
              Fühlen Sie sich von der Gewerkschaft DJP gut vertreten?
            </p>

            <div class="form-group">
              <label class="answerHead">Ihre Antwort</label>
              <select class="form-control" id="answer4">
                <option>Antwort auswählen. . .</option>
                <option>Ja</option>
                <option>Nein</option>
                <option>Weiss nicht</option>
              </select>

              <div class="form-group">
                <label class="answerHead">Sonstige Kommentare(optional)</label>
                <textarea class="form-control" id="comment4" rows="1"></textarea>
              </div>
            </div>
          </article>

<!--
          <article class="questionArticle">
            <h5>Bevor Sie Ihre Antworten absenden können, müssen Sie zum bestätigen Ihren Vollständigen Namen und Geburtsort eingeben.</h5>
            <input class="form-control" id="name" type="text" placeholder="Name">
            <input class="form-control" id="birthplace" type="text" placeholder="Geburtsort">
            <h5><strong>Überprüfen Sie Ihre Eingabe bevor Sie fortfahren!</strong></h5>
          </article>
        -->

          <div class="text-center">
            <input id="submitButton" type="submit" value="Absenden">
          </div>
        </form>
      </div>
    </section>

    <section id="success" hidden>
      <div class="container  text-center">
        <h1>Vielen Dank für Ihre Teilnahme.</h1>
      </div>
    </section>


    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-firestore.js"></script>

    <script>
      // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "AIzaSyAtfNRHN-k5WZ8RrOtTOWW-jNit4yQsHJE",
        authDomain: "umfrage-5facc.firebaseapp.com",
        databaseURL: "https://umfrage-5facc.firebaseio.com",
        projectId: "umfrage-5facc",
        storageBucket: "umfrage-5facc.appspot.com",
        messagingSenderId: "141692917536",
        appId: "1:141692917536:web:27702d2262f2d1677c6945",
        measurementId: "G-2V215MLHZJ"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
    </script>

    <script>

      function checkAnswers(returnValue) {
        var result = 0;

        var text = document.getElementById('answer1').value;
        if(text != "Antwort auswählen. . .") {
          result++;
        }

        text = document.getElementById('answer2').value;
        if(text != "Antwort auswählen. . .") {
          result++;
        }

        text = document.getElementById('answer3').value;
        if(text != "Antwort auswählen. . .") {
          result++;
        }

        text = document.getElementById('answer4').value;
        if(text != "Antwort auswählen. . .") {
          result++;
        }

        if(result == 4){
          var firstComment = document.getElementById('comment1').value == "" ? "EMPTY" : document.getElementById('comment1').value;
          var secondComment = document.getElementById('comment2').value == "" ? "EMPTY" : document.getElementById('comment2').value;
          var thirdComment = document.getElementById('comment3').value == "" ? "EMPTY" : document.getElementById('comment3').value;
          var fourthComment = document.getElementById('comment4').value == "" ? "EMPTY" : document.getElementById('comment4').value;

          var firstAnswer = document.getElementById('answer1').value;
          var secondAnswer = document.getElementById('answer2').value;
          var thirdAnswer = document.getElementById('answer3').value;
          var fourthAnswer = document.getElementById('answer4').value;

          var database = firebase.firestore();

         var answersRef = database.collection('Umfrage');
         answersRef.add({firstAnswer: firstAnswer, firstComment: firstComment, secondAnswer: secondAnswer, secondComment:  secondComment, thirdAnswer: thirdAnswer, thirdComment: thirdComment, fourthAnswer: fourthAnswer, fourthComment: fourthComment});
         document.getElementById('staticSite').setAttribute("hidden", true);
         document.getElementById('success').removeAttribute("hidden");
         /*
         answersRef.get()
           .then(function (docSnapshot) {
             if (docSnapshot.exists) {

               document.getElementById('staticSite').setAttribute("hidden", true);
               document.getElementById('dbError').removeAttribute("hidden");
             } else {

               answersRef.set({firstAnswer: firstAnswer, firstComment: firstComment, secondAnswer: secondAnswer, secondComment:  secondComment, thirdAnswer: thirdAnswer, thirdComment: thirdComment, fourthAnswer: fourthAnswer, fourthComment: fourthComment}); // create the document
               console.log("eintrag erstellt!");
               document.getElementById('staticSite').setAttribute("hidden", true);
               document.getElementById('success').removeAttribute("hidden");
             }
         });
*/
        }
        else {
          document.getElementById('error').removeAttribute("hidden");
          window.location.href="#firstHeadline";
          console.log('Error');
          console.log(4 - result + " Antworten fehlen");
        }
      }

    </script>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </body>
</html>
